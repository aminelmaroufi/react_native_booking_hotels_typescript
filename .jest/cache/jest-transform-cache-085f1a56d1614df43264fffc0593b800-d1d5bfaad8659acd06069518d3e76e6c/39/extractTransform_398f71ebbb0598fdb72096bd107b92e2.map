{"version":3,"names":["_Matrix2D","require","_transform","appendTransformProps","props","x","y","originX","originY","scaleX","scaleY","rotation","skewX","skewY","appendTransform","universal2axis","universal","axisX","axisY","defaultValue","coords","split","length","Array","isArray","isNaN","props2transform","translate","translateX","translateY","origin","scale","skew","console","warn","tr","or","sc","sk","transformToMatrix","transform","reset","append","t","parse","e","error","transformProps","toArray","extractTransform","identity"],"sources":["extractTransform.ts"],"sourcesContent":["import { append, appendTransform, identity, reset, toArray } from '../Matrix2D';\nimport { parse } from './transform';\nimport { NumberProp, TransformedProps, TransformProps } from './types';\n\nfunction appendTransformProps(props: TransformedProps) {\n  const {\n    x,\n    y,\n    originX,\n    originY,\n    scaleX,\n    scaleY,\n    rotation,\n    skewX,\n    skewY,\n  } = props;\n  appendTransform(\n    x + originX,\n    y + originY,\n    scaleX,\n    scaleY,\n    rotation,\n    skewX,\n    skewY,\n    originX,\n    originY,\n  );\n}\n\nfunction universal2axis(\n  universal: NumberProp | NumberProp[] | undefined,\n  axisX: NumberProp | void,\n  axisY: NumberProp | void,\n  defaultValue?: number,\n): [number, number] {\n  let x;\n  let y;\n  if (typeof universal === 'number') {\n    x = y = universal;\n  } else if (typeof universal === 'string') {\n    const coords = universal.split(/\\s*,\\s*/);\n    if (coords.length === 2) {\n      x = +coords[0];\n      y = +coords[1];\n    } else if (coords.length === 1) {\n      x = y = +coords[0];\n    }\n  } else if (Array.isArray(universal)) {\n    if (universal.length === 2) {\n      x = +universal[0];\n      y = +universal[1];\n    } else if (universal.length === 1) {\n      x = y = +universal[0];\n    }\n  }\n\n  axisX = +axisX;\n  if (!isNaN(axisX)) {\n    x = axisX;\n  }\n\n  axisY = +axisY;\n  if (!isNaN(axisY)) {\n    y = axisY;\n  }\n\n  return [x || defaultValue || 0, y || defaultValue || 0];\n}\n\nexport function props2transform(\n  props: TransformProps,\n): TransformedProps | null {\n  const {\n    rotation,\n    translate,\n    translateX,\n    translateY,\n    origin,\n    originX,\n    originY,\n    scale,\n    scaleX,\n    scaleY,\n    skew,\n    skewX,\n    skewY,\n    x,\n    y,\n  } = props;\n  if (\n    rotation == null &&\n    translate == null &&\n    translateX == null &&\n    translateY == null &&\n    origin == null &&\n    originX == null &&\n    originY == null &&\n    scale == null &&\n    scaleX == null &&\n    scaleY == null &&\n    skew == null &&\n    skewX == null &&\n    skewY == null &&\n    x == null &&\n    y == null\n  ) {\n    return null;\n  }\n\n  if (Array.isArray(x) || Array.isArray(y)) {\n    console.warn(\n      'Passing SvgLengthList to x or y attribute where SvgLength expected',\n    );\n  }\n  const tr = universal2axis(\n    translate,\n    translateX || (Array.isArray(x) ? x[0] : x),\n    translateY || (Array.isArray(y) ? y[0] : y),\n  );\n  const or = universal2axis(origin, originX, originY);\n  const sc = universal2axis(scale, scaleX, scaleY, 1);\n  const sk = universal2axis(skew, skewX, skewY);\n\n  return {\n    rotation: rotation == null ? 0 : +rotation || 0,\n    originX: or[0],\n    originY: or[1],\n    scaleX: sc[0],\n    scaleY: sc[1],\n    skewX: sk[0],\n    skewY: sk[1],\n    x: tr[0],\n    y: tr[1],\n  };\n}\n\nexport function transformToMatrix(\n  props: TransformedProps | null,\n  transform: number[] | string | TransformProps | void | null | undefined,\n): [number, number, number, number, number, number] | null {\n  if (!props && !transform) {\n    return null;\n  }\n  reset();\n  props && appendTransformProps(props);\n\n  if (transform) {\n    if (Array.isArray(transform)) {\n      if (typeof transform[0] === 'number') {\n        append(\n          transform[0],\n          transform[1],\n          transform[2],\n          transform[3],\n          transform[4],\n          transform[5],\n        );\n      }\n      // noop for react-native transform arrays, let animated handle them\n    } else if (typeof transform === 'string') {\n      try {\n        const t = parse(transform);\n        append(t[0], t[3], t[1], t[4], t[2], t[5]);\n      } catch (e) {\n        console.error(e);\n      }\n    } else {\n      const transformProps = props2transform(transform);\n      transformProps && appendTransformProps(transformProps);\n    }\n  }\n\n  return toArray();\n}\n\nexport default function extractTransform(\n  props: number[] | string | TransformProps,\n) {\n  if (Array.isArray(props)) {\n    return props;\n  }\n  if (typeof props === 'string') {\n    try {\n      const t = parse(props);\n      return [t[0], t[3], t[1], t[4], t[2], t[5]];\n    } catch (e) {\n      console.error(e);\n      return identity;\n    }\n  }\n  return transformToMatrix(props2transform(props), props.transform);\n}\n"],"mappings":"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"}