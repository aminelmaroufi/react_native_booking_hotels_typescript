{"version":3,"names":["_react","_interopRequireWildcard","require","_extractColor","_interopRequireDefault","_extractOpacity","_extractTransform","_units","percentReg","percentToFloat","percent","__getAnimatedValue","matched","match","console","warn","concat","offsetComparator","object","other","extractGradient","props","parent","id","children","gradientTransform","transform","gradientUnits","stops","childArray","Children","map","child","default","cloneElement","l","length","i","_childArray$i$props","style","_childArray$i$props$o","offset","_childArray$i$props$s","stopColor","_childArray$i$props$s2","stopOpacity","offsetNumber","color","isNaN","alpha","Math","round","push","sort","gradient","k","j","s","name"],"sources":["extractGradient.ts"],"sourcesContent":["import React, { Children, ReactElement } from 'react';\n\nimport extractColor from './extractColor';\nimport extractOpacity from './extractOpacity';\nimport extractTransform from './extractTransform';\nimport { TransformProps } from './types';\nimport units from '../units';\n\nconst percentReg = /^([+-]?\\d+(?:\\.\\d+)?(?:[eE][+-]?\\d+)?)(%?)$/;\n\nfunction percentToFloat(\n  percent:\n    | number\n    | string\n    | {\n        __getAnimatedValue: () => number;\n      },\n): number {\n  if (typeof percent === 'number') {\n    return percent;\n  }\n  if (\n    typeof percent === 'object' &&\n    typeof percent.__getAnimatedValue === 'function'\n  ) {\n    return percent.__getAnimatedValue();\n  }\n  const matched = typeof percent === 'string' && percent.match(percentReg);\n  if (!matched) {\n    console.warn(`\"${percent}\" is not a valid number or percentage string.`);\n    return 0;\n  }\n\n  return matched[2] ? +matched[1] / 100 : +matched[1];\n}\n\nconst offsetComparator = (object: number[], other: number[]) =>\n  object[0] - other[0];\n\nexport default function extractGradient(\n  props: {\n    id?: string;\n    children?: ReactElement[];\n    transform?: number[] | string | TransformProps;\n    gradientTransform?: number[] | string | TransformProps;\n    gradientUnits?: 'objectBoundingBox' | 'userSpaceOnUse';\n  } & TransformProps,\n  parent: {},\n) {\n  const { id, children, gradientTransform, transform, gradientUnits } = props;\n  if (!id) {\n    return null;\n  }\n\n  const stops = [];\n  const childArray = children\n    ? Children.map(children, child =>\n        React.cloneElement(child, {\n          parent,\n        }),\n      )\n    : [];\n  const l = childArray.length;\n  for (let i = 0; i < l; i++) {\n    const {\n      props: {\n        style,\n        offset = style && style.offset,\n        stopColor = (style && style.stopColor) || '#000',\n        stopOpacity = style && style.stopOpacity,\n      },\n    } = childArray[i];\n    const offsetNumber = percentToFloat(offset || 0);\n    const color = stopColor && extractColor(stopColor);\n    if (typeof color !== 'number' || isNaN(offsetNumber)) {\n      console.warn(\n        `\"${stopColor}\" is not a valid color or \"${offset}\" is not a valid offset`,\n      );\n      continue;\n    }\n    const alpha = Math.round(extractOpacity(stopOpacity) * 255);\n    stops.push([offsetNumber, (color & 0x00ffffff) | (alpha << 24)]);\n  }\n  stops.sort(offsetComparator);\n\n  const gradient = [];\n  const k = stops.length;\n  for (let j = 0; j < k; j++) {\n    const s = stops[j];\n    gradient.push(s[0], s[1]);\n  }\n\n  return {\n    name: id,\n    gradient,\n    children: childArray,\n    gradientUnits: (gradientUnits && units[gradientUnits]) || 0,\n    gradientTransform: extractTransform(\n      gradientTransform || transform || props,\n    ),\n  };\n}\n"],"mappings":"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"}