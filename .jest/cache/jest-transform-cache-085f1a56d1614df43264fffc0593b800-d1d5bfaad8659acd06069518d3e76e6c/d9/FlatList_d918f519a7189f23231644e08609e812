e3308a6ea45da875b407898f4dcb9657
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));
var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));
var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));
var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));
var _VirtualizeUtils = require("./VirtualizeUtils");
var _excluded = ["numColumns", "columnWrapperStyle", "removeClippedSubviews"];
function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }
function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }
var Platform = require('../Utilities/Platform');
var deepDiffer = require('../Utilities/differ/deepDiffer');
var React = require('react');
var View = require('../Components/View/View');
var VirtualizedList = require('./VirtualizedList');
var StyleSheet = require('../StyleSheet/StyleSheet');
var invariant = require('invariant');
function removeClippedSubviewsOrDefault(removeClippedSubviews) {
  return removeClippedSubviews != null ? removeClippedSubviews : Platform.OS === 'android';
}
function numColumnsOrDefault(numColumns) {
  return numColumns != null ? numColumns : 1;
}
var FlatList = function (_React$PureComponent) {
  (0, _inherits2.default)(FlatList, _React$PureComponent);
  var _super = _createSuper(FlatList);
  function FlatList(_props) {
    var _this;
    (0, _classCallCheck2.default)(this, FlatList);
    _this = _super.call(this, _props);
    _this._virtualizedListPairs = [];
    _this._captureRef = function (ref) {
      _this._listRef = ref;
    };
    _this._getItem = function (data, index) {
      var numColumns = numColumnsOrDefault(_this.props.numColumns);
      if (numColumns > 1) {
        var ret = [];
        for (var kk = 0; kk < numColumns; kk++) {
          var _item = data[index * numColumns + kk];
          if (_item != null) {
            ret.push(_item);
          }
        }
        return ret;
      } else {
        return data[index];
      }
    };
    _this._getItemCount = function (data) {
      if (data) {
        var numColumns = numColumnsOrDefault(_this.props.numColumns);
        return numColumns > 1 ? Math.ceil(data.length / numColumns) : data.length;
      } else {
        return 0;
      }
    };
    _this._keyExtractor = function (items, index) {
      var _this$props$keyExtrac;
      var numColumns = numColumnsOrDefault(_this.props.numColumns);
      var keyExtractor = (_this$props$keyExtrac = _this.props.keyExtractor) != null ? _this$props$keyExtrac : _VirtualizeUtils.keyExtractor;
      if (numColumns > 1) {
        if (Array.isArray(items)) {
          return items.map(function (item, kk) {
            return keyExtractor(item, index * numColumns + kk);
          }).join(':');
        } else {
          invariant(Array.isArray(items), 'FlatList: Encountered internal consistency error, expected each item to consist of an ' + 'array with 1-%s columns; instead, received a single item.', numColumns);
        }
      } else {
        return keyExtractor(items, index);
      }
    };
    _this._renderer = function () {
      var _this$props = _this.props,
        ListItemComponent = _this$props.ListItemComponent,
        renderItem = _this$props.renderItem,
        columnWrapperStyle = _this$props.columnWrapperStyle;
      var numColumns = numColumnsOrDefault(_this.props.numColumns);
      var virtualizedListRenderKey = ListItemComponent ? 'ListItemComponent' : 'renderItem';
      var renderer = function renderer(props) {
        if (ListItemComponent) {
          return React.createElement(ListItemComponent, props);
        } else if (renderItem) {
          return renderItem(props);
        } else {
          return null;
        }
      };
      return (0, _defineProperty2.default)({}, virtualizedListRenderKey, function (info) {
        if (numColumns > 1) {
          var _item2 = info.item,
            _index = info.index;
          invariant(Array.isArray(_item2), 'Expected array of items with numColumns > 1');
          return React.createElement(View, {
            style: StyleSheet.compose(styles.row, columnWrapperStyle)
          }, _item2.map(function (it, kk) {
            var element = renderer({
              item: it,
              index: _index * numColumns + kk,
              separators: info.separators
            });
            return element != null ? React.createElement(React.Fragment, {
              key: kk
            }, element) : null;
          }));
        } else {
          return renderer(info);
        }
      });
    };
    _this._checkProps(_this.props);
    if (_this.props.viewabilityConfigCallbackPairs) {
      _this._virtualizedListPairs = _this.props.viewabilityConfigCallbackPairs.map(function (pair) {
        return {
          viewabilityConfig: pair.viewabilityConfig,
          onViewableItemsChanged: _this._createOnViewableItemsChanged(pair.onViewableItemsChanged)
        };
      });
    } else if (_this.props.onViewableItemsChanged) {
      _this._virtualizedListPairs.push({
        viewabilityConfig: _this.props.viewabilityConfig,
        onViewableItemsChanged: _this._createOnViewableItemsChanged(_this.props.onViewableItemsChanged)
      });
    }
    return _this;
  }
  (0, _createClass2.default)(FlatList, [{
    key: "scrollToEnd",
    value: function scrollToEnd(params) {
      if (this._listRef) {
        this._listRef.scrollToEnd(params);
      }
    }
  }, {
    key: "scrollToIndex",
    value: function scrollToIndex(params) {
      if (this._listRef) {
        this._listRef.scrollToIndex(params);
      }
    }
  }, {
    key: "scrollToItem",
    value: function scrollToItem(params) {
      if (this._listRef) {
        this._listRef.scrollToItem(params);
      }
    }
  }, {
    key: "scrollToOffset",
    value: function scrollToOffset(params) {
      if (this._listRef) {
        this._listRef.scrollToOffset(params);
      }
    }
  }, {
    key: "recordInteraction",
    value: function recordInteraction() {
      if (this._listRef) {
        this._listRef.recordInteraction();
      }
    }
  }, {
    key: "flashScrollIndicators",
    value: function flashScrollIndicators() {
      if (this._listRef) {
        this._listRef.flashScrollIndicators();
      }
    }
  }, {
    key: "getScrollResponder",
    value: function getScrollResponder() {
      if (this._listRef) {
        return this._listRef.getScrollResponder();
      }
    }
  }, {
    key: "getNativeScrollRef",
    value: function getNativeScrollRef() {
      if (this._listRef) {
        return this._listRef.getScrollRef();
      }
    }
  }, {
    key: "getScrollableNode",
    value: function getScrollableNode() {
      if (this._listRef) {
        return this._listRef.getScrollableNode();
      }
    }
  }, {
    key: "setNativeProps",
    value: function setNativeProps(props) {
      if (this._listRef) {
        this._listRef.setNativeProps(props);
      }
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      invariant(prevProps.numColumns === this.props.numColumns, 'Changing numColumns on the fly is not supported. Change the key prop on FlatList when ' + 'changing the number of columns to force a fresh render of the component.');
      invariant(prevProps.onViewableItemsChanged === this.props.onViewableItemsChanged, 'Changing onViewableItemsChanged on the fly is not supported');
      invariant(!deepDiffer(prevProps.viewabilityConfig, this.props.viewabilityConfig), 'Changing viewabilityConfig on the fly is not supported');
      invariant(prevProps.viewabilityConfigCallbackPairs === this.props.viewabilityConfigCallbackPairs, 'Changing viewabilityConfigCallbackPairs on the fly is not supported');
      this._checkProps(this.props);
    }
  }, {
    key: "_checkProps",
    value: function _checkProps(props) {
      var getItem = props.getItem,
        getItemCount = props.getItemCount,
        horizontal = props.horizontal,
        columnWrapperStyle = props.columnWrapperStyle,
        onViewableItemsChanged = props.onViewableItemsChanged,
        viewabilityConfigCallbackPairs = props.viewabilityConfigCallbackPairs;
      var numColumns = numColumnsOrDefault(this.props.numColumns);
      invariant(!getItem && !getItemCount, 'FlatList does not support custom data formats.');
      if (numColumns > 1) {
        invariant(!horizontal, 'numColumns does not support horizontal.');
      } else {
        invariant(!columnWrapperStyle, 'columnWrapperStyle not supported for single column lists');
      }
      invariant(!(onViewableItemsChanged && viewabilityConfigCallbackPairs), 'FlatList does not support setting both onViewableItemsChanged and ' + 'viewabilityConfigCallbackPairs.');
    }
  }, {
    key: "_pushMultiColumnViewable",
    value: function _pushMultiColumnViewable(arr, v) {
      var _this$props$keyExtrac2;
      var numColumns = numColumnsOrDefault(this.props.numColumns);
      var keyExtractor = (_this$props$keyExtrac2 = this.props.keyExtractor) != null ? _this$props$keyExtrac2 : _VirtualizeUtils.keyExtractor;
      v.item.forEach(function (item, ii) {
        invariant(v.index != null, 'Missing index!');
        var index = v.index * numColumns + ii;
        arr.push((0, _extends2.default)({}, v, {
          item: item,
          key: keyExtractor(item, index),
          index: index
        }));
      });
    }
  }, {
    key: "_createOnViewableItemsChanged",
    value: function _createOnViewableItemsChanged(onViewableItemsChanged) {
      var _this2 = this;
      return function (info) {
        var numColumns = numColumnsOrDefault(_this2.props.numColumns);
        if (onViewableItemsChanged) {
          if (numColumns > 1) {
            var changed = [];
            var viewableItems = [];
            info.viewableItems.forEach(function (v) {
              return _this2._pushMultiColumnViewable(viewableItems, v);
            });
            info.changed.forEach(function (v) {
              return _this2._pushMultiColumnViewable(changed, v);
            });
            onViewableItemsChanged({
              viewableItems: viewableItems,
              changed: changed
            });
          } else {
            onViewableItemsChanged(info);
          }
        }
      };
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props2 = this.props,
        numColumns = _this$props2.numColumns,
        columnWrapperStyle = _this$props2.columnWrapperStyle,
        _removeClippedSubviews = _this$props2.removeClippedSubviews,
        restProps = (0, _objectWithoutProperties2.default)(_this$props2, _excluded);
      return React.createElement(VirtualizedList, (0, _extends2.default)({}, restProps, {
        getItem: this._getItem,
        getItemCount: this._getItemCount,
        keyExtractor: this._keyExtractor,
        ref: this._captureRef,
        viewabilityConfigCallbackPairs: this._virtualizedListPairs,
        removeClippedSubviews: removeClippedSubviewsOrDefault(_removeClippedSubviews)
      }, this._renderer()));
    }
  }]);
  return FlatList;
}(React.PureComponent);
var styles = StyleSheet.create({
  row: {
    flexDirection: 'row'
  }
});
module.exports = FlatList;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfVmlydHVhbGl6ZVV0aWxzIiwicmVxdWlyZSIsIl9leGNsdWRlZCIsIl9jcmVhdGVTdXBlciIsIkRlcml2ZWQiLCJoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0IiwiX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCIsIl9jcmVhdGVTdXBlckludGVybmFsIiwiU3VwZXIiLCJfZ2V0UHJvdG90eXBlT2YyIiwiZGVmYXVsdCIsInJlc3VsdCIsIk5ld1RhcmdldCIsImNvbnN0cnVjdG9yIiwiUmVmbGVjdCIsImNvbnN0cnVjdCIsImFyZ3VtZW50cyIsImFwcGx5IiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yIiwic2hhbSIsIlByb3h5IiwiQm9vbGVhbiIsInByb3RvdHlwZSIsInZhbHVlT2YiLCJjYWxsIiwiZSIsIlBsYXRmb3JtIiwiZGVlcERpZmZlciIsIlJlYWN0IiwiVmlldyIsIlZpcnR1YWxpemVkTGlzdCIsIlN0eWxlU2hlZXQiLCJpbnZhcmlhbnQiLCJyZW1vdmVDbGlwcGVkU3Vidmlld3NPckRlZmF1bHQiLCJyZW1vdmVDbGlwcGVkU3Vidmlld3MiLCJPUyIsIm51bUNvbHVtbnNPckRlZmF1bHQiLCJudW1Db2x1bW5zIiwiRmxhdExpc3QiLCJfUmVhY3QkUHVyZUNvbXBvbmVudCIsIl9pbmhlcml0czIiLCJfc3VwZXIiLCJwcm9wcyIsIl90aGlzIiwiX2NsYXNzQ2FsbENoZWNrMiIsIl92aXJ0dWFsaXplZExpc3RQYWlycyIsIl9jYXB0dXJlUmVmIiwicmVmIiwiX2xpc3RSZWYiLCJfZ2V0SXRlbSIsImRhdGEiLCJpbmRleCIsInJldCIsImtrIiwiaXRlbSIsInB1c2giLCJfZ2V0SXRlbUNvdW50IiwiTWF0aCIsImNlaWwiLCJsZW5ndGgiLCJfa2V5RXh0cmFjdG9yIiwiaXRlbXMiLCJfdGhpcyRwcm9wcyRrZXlFeHRyYWMiLCJrZXlFeHRyYWN0b3IiLCJkZWZhdWx0S2V5RXh0cmFjdG9yIiwiQXJyYXkiLCJpc0FycmF5IiwibWFwIiwiam9pbiIsIl9yZW5kZXJlciIsIl90aGlzJHByb3BzIiwiTGlzdEl0ZW1Db21wb25lbnQiLCJyZW5kZXJJdGVtIiwiY29sdW1uV3JhcHBlclN0eWxlIiwidmlydHVhbGl6ZWRMaXN0UmVuZGVyS2V5IiwicmVuZGVyZXIiLCJjcmVhdGVFbGVtZW50IiwiX2RlZmluZVByb3BlcnR5MiIsImluZm8iLCJzdHlsZSIsImNvbXBvc2UiLCJzdHlsZXMiLCJyb3ciLCJpdCIsImVsZW1lbnQiLCJzZXBhcmF0b3JzIiwiRnJhZ21lbnQiLCJrZXkiLCJfY2hlY2tQcm9wcyIsInZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycyIsInBhaXIiLCJ2aWV3YWJpbGl0eUNvbmZpZyIsIm9uVmlld2FibGVJdGVtc0NoYW5nZWQiLCJfY3JlYXRlT25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCIsIl9jcmVhdGVDbGFzczIiLCJ2YWx1ZSIsInNjcm9sbFRvRW5kIiwicGFyYW1zIiwic2Nyb2xsVG9JbmRleCIsInNjcm9sbFRvSXRlbSIsInNjcm9sbFRvT2Zmc2V0IiwicmVjb3JkSW50ZXJhY3Rpb24iLCJmbGFzaFNjcm9sbEluZGljYXRvcnMiLCJnZXRTY3JvbGxSZXNwb25kZXIiLCJnZXROYXRpdmVTY3JvbGxSZWYiLCJnZXRTY3JvbGxSZWYiLCJnZXRTY3JvbGxhYmxlTm9kZSIsInNldE5hdGl2ZVByb3BzIiwiY29tcG9uZW50RGlkVXBkYXRlIiwicHJldlByb3BzIiwiZ2V0SXRlbSIsImdldEl0ZW1Db3VudCIsImhvcml6b250YWwiLCJfcHVzaE11bHRpQ29sdW1uVmlld2FibGUiLCJhcnIiLCJ2IiwiX3RoaXMkcHJvcHMka2V5RXh0cmFjMiIsImZvckVhY2giLCJpaSIsIl9leHRlbmRzMiIsIl90aGlzMiIsImNoYW5nZWQiLCJ2aWV3YWJsZUl0ZW1zIiwicmVuZGVyIiwiX3RoaXMkcHJvcHMyIiwiX3JlbW92ZUNsaXBwZWRTdWJ2aWV3cyIsInJlc3RQcm9wcyIsIl9vYmplY3RXaXRob3V0UHJvcGVydGllczIiLCJQdXJlQ29tcG9uZW50IiwiY3JlYXRlIiwiZmxleERpcmVjdGlvbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJGbGF0TGlzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuY29uc3QgUGxhdGZvcm0gPSByZXF1aXJlKCcuLi9VdGlsaXRpZXMvUGxhdGZvcm0nKTtcbmNvbnN0IGRlZXBEaWZmZXIgPSByZXF1aXJlKCcuLi9VdGlsaXRpZXMvZGlmZmVyL2RlZXBEaWZmZXInKTtcbmNvbnN0IFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcbmNvbnN0IFZpZXcgPSByZXF1aXJlKCcuLi9Db21wb25lbnRzL1ZpZXcvVmlldycpO1xuY29uc3QgVmlydHVhbGl6ZWRMaXN0ID0gcmVxdWlyZSgnLi9WaXJ0dWFsaXplZExpc3QnKTtcbmNvbnN0IFN0eWxlU2hlZXQgPSByZXF1aXJlKCcuLi9TdHlsZVNoZWV0L1N0eWxlU2hlZXQnKTtcblxuY29uc3QgaW52YXJpYW50ID0gcmVxdWlyZSgnaW52YXJpYW50Jyk7XG5cbmltcG9ydCB0eXBlb2YgU2Nyb2xsVmlld05hdGl2ZUNvbXBvbmVudCBmcm9tICcuLi9Db21wb25lbnRzL1Njcm9sbFZpZXcvU2Nyb2xsVmlld05hdGl2ZUNvbXBvbmVudCc7XG5pbXBvcnQge3R5cGUgU2Nyb2xsUmVzcG9uZGVyVHlwZX0gZnJvbSAnLi4vQ29tcG9uZW50cy9TY3JvbGxWaWV3L1Njcm9sbFZpZXcnO1xuaW1wb3J0IHR5cGUge1ZpZXdTdHlsZVByb3B9IGZyb20gJy4uL1N0eWxlU2hlZXQvU3R5bGVTaGVldCc7XG5pbXBvcnQgdHlwZSB7XG4gIFZpZXdUb2tlbixcbiAgVmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXIsXG59IGZyb20gJy4vVmlld2FiaWxpdHlIZWxwZXInO1xuaW1wb3J0IHR5cGUge1JlbmRlckl0ZW1UeXBlLCBSZW5kZXJJdGVtUHJvcHN9IGZyb20gJy4vVmlydHVhbGl6ZWRMaXN0JztcbmltcG9ydCB7a2V5RXh0cmFjdG9yIGFzIGRlZmF1bHRLZXlFeHRyYWN0b3J9IGZyb20gJy4vVmlydHVhbGl6ZVV0aWxzJztcblxudHlwZSBSZXF1aXJlZFByb3BzPEl0ZW1UPiA9IHt8XG4gIC8qKlxuICAgKiBGb3Igc2ltcGxpY2l0eSwgZGF0YSBpcyBqdXN0IGEgcGxhaW4gYXJyYXkuIElmIHlvdSB3YW50IHRvIHVzZSBzb21ldGhpbmcgZWxzZSwgbGlrZSBhblxuICAgKiBpbW11dGFibGUgbGlzdCwgdXNlIHRoZSB1bmRlcmx5aW5nIGBWaXJ0dWFsaXplZExpc3RgIGRpcmVjdGx5LlxuICAgKi9cbiAgZGF0YTogPyRSZWFkT25seUFycmF5PEl0ZW1UPixcbnx9O1xudHlwZSBPcHRpb25hbFByb3BzPEl0ZW1UPiA9IHt8XG4gIC8qKlxuICAgKiBUYWtlcyBhbiBpdGVtIGZyb20gYGRhdGFgIGFuZCByZW5kZXJzIGl0IGludG8gdGhlIGxpc3QuIEV4YW1wbGUgdXNhZ2U6XG4gICAqXG4gICAqICAgICA8RmxhdExpc3RcbiAgICogICAgICAgSXRlbVNlcGFyYXRvckNvbXBvbmVudD17UGxhdGZvcm0uT1MgIT09ICdhbmRyb2lkJyAmJiAoe2hpZ2hsaWdodGVkfSkgPT4gKFxuICAgKiAgICAgICAgIDxWaWV3IHN0eWxlPXtbc3R5bGUuc2VwYXJhdG9yLCBoaWdobGlnaHRlZCAmJiB7bWFyZ2luTGVmdDogMH1dfSAvPlxuICAgKiAgICAgICApfVxuICAgKiAgICAgICBkYXRhPXtbe3RpdGxlOiAnVGl0bGUgVGV4dCcsIGtleTogJ2l0ZW0xJ31dfVxuICAgKiAgICAgICByZW5kZXJJdGVtPXsoe2l0ZW0sIHNlcGFyYXRvcnN9KSA9PiAoXG4gICAqICAgICAgICAgPFRvdWNoYWJsZUhpZ2hsaWdodFxuICAgKiAgICAgICAgICAgb25QcmVzcz17KCkgPT4gdGhpcy5fb25QcmVzcyhpdGVtKX1cbiAgICogICAgICAgICAgIG9uU2hvd1VuZGVybGF5PXtzZXBhcmF0b3JzLmhpZ2hsaWdodH1cbiAgICogICAgICAgICAgIG9uSGlkZVVuZGVybGF5PXtzZXBhcmF0b3JzLnVuaGlnaGxpZ2h0fT5cbiAgICogICAgICAgICAgIDxWaWV3IHN0eWxlPXt7YmFja2dyb3VuZENvbG9yOiAnd2hpdGUnfX0+XG4gICAqICAgICAgICAgICAgIDxUZXh0PntpdGVtLnRpdGxlfTwvVGV4dD5cbiAgICogICAgICAgICAgIDwvVmlldz5cbiAgICogICAgICAgICA8L1RvdWNoYWJsZUhpZ2hsaWdodD5cbiAgICogICAgICAgKX1cbiAgICogICAgIC8+XG4gICAqXG4gICAqIFByb3ZpZGVzIGFkZGl0aW9uYWwgbWV0YWRhdGEgbGlrZSBgaW5kZXhgIGlmIHlvdSBuZWVkIGl0LCBhcyB3ZWxsIGFzIGEgbW9yZSBnZW5lcmljXG4gICAqIGBzZXBhcmF0b3JzLnVwZGF0ZVByb3BzYCBmdW5jdGlvbiB3aGljaCBsZXQncyB5b3Ugc2V0IHdoYXRldmVyIHByb3BzIHlvdSB3YW50IHRvIGNoYW5nZSB0aGVcbiAgICogcmVuZGVyaW5nIG9mIGVpdGhlciB0aGUgbGVhZGluZyBzZXBhcmF0b3Igb3IgdHJhaWxpbmcgc2VwYXJhdG9yIGluIGNhc2UgdGhlIG1vcmUgY29tbW9uXG4gICAqIGBoaWdobGlnaHRgIGFuZCBgdW5oaWdobGlnaHRgICh3aGljaCBzZXQgdGhlIGBoaWdobGlnaHRlZDogYm9vbGVhbmAgcHJvcCkgYXJlIGluc3VmZmljaWVudCBmb3JcbiAgICogeW91ciB1c2UtY2FzZS5cbiAgICovXG4gIHJlbmRlckl0ZW0/OiA/UmVuZGVySXRlbVR5cGU8SXRlbVQ+LFxuXG4gIC8qKlxuICAgKiBPcHRpb25hbCBjdXN0b20gc3R5bGUgZm9yIG11bHRpLWl0ZW0gcm93cyBnZW5lcmF0ZWQgd2hlbiBudW1Db2x1bW5zID4gMS5cbiAgICovXG4gIGNvbHVtbldyYXBwZXJTdHlsZT86IFZpZXdTdHlsZVByb3AsXG4gIC8qKlxuICAgKiBBIG1hcmtlciBwcm9wZXJ0eSBmb3IgdGVsbGluZyB0aGUgbGlzdCB0byByZS1yZW5kZXIgKHNpbmNlIGl0IGltcGxlbWVudHMgYFB1cmVDb21wb25lbnRgKS4gSWZcbiAgICogYW55IG9mIHlvdXIgYHJlbmRlckl0ZW1gLCBIZWFkZXIsIEZvb3RlciwgZXRjLiBmdW5jdGlvbnMgZGVwZW5kIG9uIGFueXRoaW5nIG91dHNpZGUgb2YgdGhlXG4gICAqIGBkYXRhYCBwcm9wLCBzdGljayBpdCBoZXJlIGFuZCB0cmVhdCBpdCBpbW11dGFibHkuXG4gICAqL1xuICBleHRyYURhdGE/OiBhbnksXG4gIC8qKlxuICAgKiBgZ2V0SXRlbUxheW91dGAgaXMgYW4gb3B0aW9uYWwgb3B0aW1pemF0aW9ucyB0aGF0IGxldCB1cyBza2lwIG1lYXN1cmVtZW50IG9mIGR5bmFtaWMgY29udGVudCBpZlxuICAgKiB5b3Uga25vdyB0aGUgaGVpZ2h0IG9mIGl0ZW1zIGEgcHJpb3JpLiBgZ2V0SXRlbUxheW91dGAgaXMgdGhlIG1vc3QgZWZmaWNpZW50LCBhbmQgaXMgZWFzeSB0b1xuICAgKiB1c2UgaWYgeW91IGhhdmUgZml4ZWQgaGVpZ2h0IGl0ZW1zLCBmb3IgZXhhbXBsZTpcbiAgICpcbiAgICogICAgIGdldEl0ZW1MYXlvdXQ9eyhkYXRhLCBpbmRleCkgPT4gKFxuICAgKiAgICAgICB7bGVuZ3RoOiBJVEVNX0hFSUdIVCwgb2Zmc2V0OiBJVEVNX0hFSUdIVCAqIGluZGV4LCBpbmRleH1cbiAgICogICAgICl9XG4gICAqXG4gICAqIEFkZGluZyBgZ2V0SXRlbUxheW91dGAgY2FuIGJlIGEgZ3JlYXQgcGVyZm9ybWFuY2UgYm9vc3QgZm9yIGxpc3RzIG9mIHNldmVyYWwgaHVuZHJlZCBpdGVtcy5cbiAgICogUmVtZW1iZXIgdG8gaW5jbHVkZSBzZXBhcmF0b3IgbGVuZ3RoIChoZWlnaHQgb3Igd2lkdGgpIGluIHlvdXIgb2Zmc2V0IGNhbGN1bGF0aW9uIGlmIHlvdVxuICAgKiBzcGVjaWZ5IGBJdGVtU2VwYXJhdG9yQ29tcG9uZW50YC5cbiAgICovXG4gIGdldEl0ZW1MYXlvdXQ/OiAoXG4gICAgZGF0YTogP0FycmF5PEl0ZW1UPixcbiAgICBpbmRleDogbnVtYmVyLFxuICApID0+IHtcbiAgICBsZW5ndGg6IG51bWJlcixcbiAgICBvZmZzZXQ6IG51bWJlcixcbiAgICBpbmRleDogbnVtYmVyLFxuICAgIC4uLlxuICB9LFxuICAvKipcbiAgICogSWYgdHJ1ZSwgcmVuZGVycyBpdGVtcyBuZXh0IHRvIGVhY2ggb3RoZXIgaG9yaXpvbnRhbGx5IGluc3RlYWQgb2Ygc3RhY2tlZCB2ZXJ0aWNhbGx5LlxuICAgKi9cbiAgaG9yaXpvbnRhbD86ID9ib29sZWFuLFxuICAvKipcbiAgICogSG93IG1hbnkgaXRlbXMgdG8gcmVuZGVyIGluIHRoZSBpbml0aWFsIGJhdGNoLiBUaGlzIHNob3VsZCBiZSBlbm91Z2ggdG8gZmlsbCB0aGUgc2NyZWVuIGJ1dCBub3RcbiAgICogbXVjaCBtb3JlLiBOb3RlIHRoZXNlIGl0ZW1zIHdpbGwgbmV2ZXIgYmUgdW5tb3VudGVkIGFzIHBhcnQgb2YgdGhlIHdpbmRvd2VkIHJlbmRlcmluZyBpbiBvcmRlclxuICAgKiB0byBpbXByb3ZlIHBlcmNlaXZlZCBwZXJmb3JtYW5jZSBvZiBzY3JvbGwtdG8tdG9wIGFjdGlvbnMuXG4gICAqL1xuICBpbml0aWFsTnVtVG9SZW5kZXI/OiA/bnVtYmVyLFxuICAvKipcbiAgICogSW5zdGVhZCBvZiBzdGFydGluZyBhdCB0aGUgdG9wIHdpdGggdGhlIGZpcnN0IGl0ZW0sIHN0YXJ0IGF0IGBpbml0aWFsU2Nyb2xsSW5kZXhgLiBUaGlzXG4gICAqIGRpc2FibGVzIHRoZSBcInNjcm9sbCB0byB0b3BcIiBvcHRpbWl6YXRpb24gdGhhdCBrZWVwcyB0aGUgZmlyc3QgYGluaXRpYWxOdW1Ub1JlbmRlcmAgaXRlbXNcbiAgICogYWx3YXlzIHJlbmRlcmVkIGFuZCBpbW1lZGlhdGVseSByZW5kZXJzIHRoZSBpdGVtcyBzdGFydGluZyBhdCB0aGlzIGluaXRpYWwgaW5kZXguIFJlcXVpcmVzXG4gICAqIGBnZXRJdGVtTGF5b3V0YCB0byBiZSBpbXBsZW1lbnRlZC5cbiAgICovXG4gIGluaXRpYWxTY3JvbGxJbmRleD86ID9udW1iZXIsXG4gIC8qKlxuICAgKiBSZXZlcnNlcyB0aGUgZGlyZWN0aW9uIG9mIHNjcm9sbC4gVXNlcyBzY2FsZSB0cmFuc2Zvcm1zIG9mIC0xLlxuICAgKi9cbiAgaW52ZXJ0ZWQ/OiA/Ym9vbGVhbixcbiAgLyoqXG4gICAqIFVzZWQgdG8gZXh0cmFjdCBhIHVuaXF1ZSBrZXkgZm9yIGEgZ2l2ZW4gaXRlbSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LiBLZXkgaXMgdXNlZCBmb3IgY2FjaGluZ1xuICAgKiBhbmQgYXMgdGhlIHJlYWN0IGtleSB0byB0cmFjayBpdGVtIHJlLW9yZGVyaW5nLiBUaGUgZGVmYXVsdCBleHRyYWN0b3IgY2hlY2tzIGBpdGVtLmtleWAsIHRoZW5cbiAgICogZmFsbHMgYmFjayB0byB1c2luZyB0aGUgaW5kZXgsIGxpa2UgUmVhY3QgZG9lcy5cbiAgICovXG4gIGtleUV4dHJhY3Rvcj86ID8oaXRlbTogSXRlbVQsIGluZGV4OiBudW1iZXIpID0+IHN0cmluZyxcbiAgLyoqXG4gICAqIE11bHRpcGxlIGNvbHVtbnMgY2FuIG9ubHkgYmUgcmVuZGVyZWQgd2l0aCBgaG9yaXpvbnRhbD17ZmFsc2V9YCBhbmQgd2lsbCB6aWctemFnIGxpa2UgYVxuICAgKiBgZmxleFdyYXBgIGxheW91dC4gSXRlbXMgc2hvdWxkIGFsbCBiZSB0aGUgc2FtZSBoZWlnaHQgLSBtYXNvbnJ5IGxheW91dHMgYXJlIG5vdCBzdXBwb3J0ZWQuXG4gICAqXG4gICAqIFRoZSBkZWZhdWx0IHZhbHVlIGlzIDEuXG4gICAqL1xuICBudW1Db2x1bW5zPzogbnVtYmVyLFxuICAvKipcbiAgICogTm90ZTogbWF5IGhhdmUgYnVncyAobWlzc2luZyBjb250ZW50KSBpbiBzb21lIGNpcmN1bXN0YW5jZXMgLSB1c2UgYXQgeW91ciBvd24gcmlzay5cbiAgICpcbiAgICogVGhpcyBtYXkgaW1wcm92ZSBzY3JvbGwgcGVyZm9ybWFuY2UgZm9yIGxhcmdlIGxpc3RzLlxuICAgKlxuICAgKiBUaGUgZGVmYXVsdCB2YWx1ZSBpcyB0cnVlIGZvciBBbmRyb2lkLlxuICAgKi9cbiAgcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzPzogYm9vbGVhbixcbiAgLyoqXG4gICAqIFNlZSBgU2Nyb2xsVmlld2AgZm9yIGZsb3cgdHlwZSBhbmQgZnVydGhlciBkb2N1bWVudGF0aW9uLlxuICAgKi9cbiAgZmFkaW5nRWRnZUxlbmd0aD86ID9udW1iZXIsXG58fTtcblxuLyoqXG4gKiBEZWZhdWx0IFByb3BzIEhlbHBlciBGdW5jdGlvbnNcbiAqIFVzZSB0aGUgZm9sbG93aW5nIGhlbHBlciBmdW5jdGlvbnMgZm9yIGRlZmF1bHQgdmFsdWVzXG4gKi9cblxuLy8gcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzT3JEZWZhdWx0KHRoaXMucHJvcHMucmVtb3ZlQ2xpcHBlZFN1YnZpZXdzKVxuZnVuY3Rpb24gcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzT3JEZWZhdWx0KHJlbW92ZUNsaXBwZWRTdWJ2aWV3czogP2Jvb2xlYW4pIHtcbiAgcmV0dXJuIHJlbW92ZUNsaXBwZWRTdWJ2aWV3cyA/PyBQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnO1xufVxuXG4vLyBudW1Db2x1bW5zT3JEZWZhdWx0KHRoaXMucHJvcHMubnVtQ29sdW1ucylcbmZ1bmN0aW9uIG51bUNvbHVtbnNPckRlZmF1bHQobnVtQ29sdW1uczogP251bWJlcikge1xuICByZXR1cm4gbnVtQ29sdW1ucyA/PyAxO1xufVxuXG50eXBlIEZsYXRMaXN0UHJvcHM8SXRlbVQ+ID0ge3xcbiAgLi4uUmVxdWlyZWRQcm9wczxJdGVtVD4sXG4gIC4uLk9wdGlvbmFsUHJvcHM8SXRlbVQ+LFxufH07XG5cbnR5cGUgVmlydHVhbGl6ZWRMaXN0UHJvcHMgPSBSZWFjdC5FbGVtZW50Q29uZmlnPHR5cGVvZiBWaXJ0dWFsaXplZExpc3Q+O1xuXG5leHBvcnQgdHlwZSBQcm9wczxJdGVtVD4gPSB7XG4gIC4uLiREaWZmPFxuICAgIFZpcnR1YWxpemVkTGlzdFByb3BzLFxuICAgIHtcbiAgICAgIGdldEl0ZW06ICRQcm9wZXJ0eVR5cGU8VmlydHVhbGl6ZWRMaXN0UHJvcHMsICdnZXRJdGVtJz4sXG4gICAgICBnZXRJdGVtQ291bnQ6ICRQcm9wZXJ0eVR5cGU8VmlydHVhbGl6ZWRMaXN0UHJvcHMsICdnZXRJdGVtQ291bnQnPixcbiAgICAgIGdldEl0ZW1MYXlvdXQ6ICRQcm9wZXJ0eVR5cGU8VmlydHVhbGl6ZWRMaXN0UHJvcHMsICdnZXRJdGVtTGF5b3V0Jz4sXG4gICAgICByZW5kZXJJdGVtOiAkUHJvcGVydHlUeXBlPFZpcnR1YWxpemVkTGlzdFByb3BzLCAncmVuZGVySXRlbSc+LFxuICAgICAga2V5RXh0cmFjdG9yOiAkUHJvcGVydHlUeXBlPFZpcnR1YWxpemVkTGlzdFByb3BzLCAna2V5RXh0cmFjdG9yJz4sXG4gICAgICAuLi5cbiAgICB9LFxuICA+LFxuICAuLi5GbGF0TGlzdFByb3BzPEl0ZW1UPixcbiAgLi4uXG59O1xuXG4vKipcbiAqIEEgcGVyZm9ybWFudCBpbnRlcmZhY2UgZm9yIHJlbmRlcmluZyBzaW1wbGUsIGZsYXQgbGlzdHMsIHN1cHBvcnRpbmcgdGhlIG1vc3QgaGFuZHkgZmVhdHVyZXM6XG4gKlxuICogIC0gRnVsbHkgY3Jvc3MtcGxhdGZvcm0uXG4gKiAgLSBPcHRpb25hbCBob3Jpem9udGFsIG1vZGUuXG4gKiAgLSBDb25maWd1cmFibGUgdmlld2FiaWxpdHkgY2FsbGJhY2tzLlxuICogIC0gSGVhZGVyIHN1cHBvcnQuXG4gKiAgLSBGb290ZXIgc3VwcG9ydC5cbiAqICAtIFNlcGFyYXRvciBzdXBwb3J0LlxuICogIC0gUHVsbCB0byBSZWZyZXNoLlxuICogIC0gU2Nyb2xsIGxvYWRpbmcuXG4gKiAgLSBTY3JvbGxUb0luZGV4IHN1cHBvcnQuXG4gKlxuICogSWYgeW91IG5lZWQgc2VjdGlvbiBzdXBwb3J0LCB1c2UgW2A8U2VjdGlvbkxpc3Q+YF0oZG9jcy9zZWN0aW9ubGlzdC5odG1sKS5cbiAqXG4gKiBNaW5pbWFsIEV4YW1wbGU6XG4gKlxuICogICAgIDxGbGF0TGlzdFxuICogICAgICAgZGF0YT17W3trZXk6ICdhJ30sIHtrZXk6ICdiJ31dfVxuICogICAgICAgcmVuZGVySXRlbT17KHtpdGVtfSkgPT4gPFRleHQ+e2l0ZW0ua2V5fTwvVGV4dD59XG4gKiAgICAgLz5cbiAqXG4gKiBNb3JlIGNvbXBsZXgsIG11bHRpLXNlbGVjdCBleGFtcGxlIGRlbW9uc3RyYXRpbmcgYFB1cmVDb21wb25lbnRgIHVzYWdlIGZvciBwZXJmIG9wdGltaXphdGlvbiBhbmQgYXZvaWRpbmcgYnVncy5cbiAqXG4gKiAtIEJ5IGJpbmRpbmcgdGhlIGBvblByZXNzSXRlbWAgaGFuZGxlciwgdGhlIHByb3BzIHdpbGwgcmVtYWluIGA9PT1gIGFuZCBgUHVyZUNvbXBvbmVudGAgd2lsbFxuICogICBwcmV2ZW50IHdhc3RlZnVsIHJlLXJlbmRlcnMgdW5sZXNzIHRoZSBhY3R1YWwgYGlkYCwgYHNlbGVjdGVkYCwgb3IgYHRpdGxlYCBwcm9wcyBjaGFuZ2UsIGV2ZW5cbiAqICAgaWYgdGhlIGNvbXBvbmVudHMgcmVuZGVyZWQgaW4gYE15TGlzdEl0ZW1gIGRpZCBub3QgaGF2ZSBzdWNoIG9wdGltaXphdGlvbnMuXG4gKiAtIEJ5IHBhc3NpbmcgYGV4dHJhRGF0YT17dGhpcy5zdGF0ZX1gIHRvIGBGbGF0TGlzdGAgd2UgbWFrZSBzdXJlIGBGbGF0TGlzdGAgaXRzZWxmIHdpbGwgcmUtcmVuZGVyXG4gKiAgIHdoZW4gdGhlIGBzdGF0ZS5zZWxlY3RlZGAgY2hhbmdlcy4gV2l0aG91dCBzZXR0aW5nIHRoaXMgcHJvcCwgYEZsYXRMaXN0YCB3b3VsZCBub3Qga25vdyBpdFxuICogICBuZWVkcyB0byByZS1yZW5kZXIgYW55IGl0ZW1zIGJlY2F1c2UgaXQgaXMgYWxzbyBhIGBQdXJlQ29tcG9uZW50YCBhbmQgdGhlIHByb3AgY29tcGFyaXNvbiB3aWxsXG4gKiAgIG5vdCBzaG93IGFueSBjaGFuZ2VzLlxuICogLSBga2V5RXh0cmFjdG9yYCB0ZWxscyB0aGUgbGlzdCB0byB1c2UgdGhlIGBpZGBzIGZvciB0aGUgcmVhY3Qga2V5cyBpbnN0ZWFkIG9mIHRoZSBkZWZhdWx0IGBrZXlgIHByb3BlcnR5LlxuICpcbiAqXG4gKiAgICAgY2xhc3MgTXlMaXN0SXRlbSBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQge1xuICogICAgICAgX29uUHJlc3MgPSAoKSA9PiB7XG4gKiAgICAgICAgIHRoaXMucHJvcHMub25QcmVzc0l0ZW0odGhpcy5wcm9wcy5pZCk7XG4gKiAgICAgICB9O1xuICpcbiAqICAgICAgIHJlbmRlcigpIHtcbiAqICAgICAgICAgY29uc3QgdGV4dENvbG9yID0gdGhpcy5wcm9wcy5zZWxlY3RlZCA/IFwicmVkXCIgOiBcImJsYWNrXCI7XG4gKiAgICAgICAgIHJldHVybiAoXG4gKiAgICAgICAgICAgPFRvdWNoYWJsZU9wYWNpdHkgb25QcmVzcz17dGhpcy5fb25QcmVzc30+XG4gKiAgICAgICAgICAgICA8Vmlldz5cbiAqICAgICAgICAgICAgICAgPFRleHQgc3R5bGU9e3sgY29sb3I6IHRleHRDb2xvciB9fT5cbiAqICAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy50aXRsZX1cbiAqICAgICAgICAgICAgICAgPC9UZXh0PlxuICogICAgICAgICAgICAgPC9WaWV3PlxuICogICAgICAgICAgIDwvVG91Y2hhYmxlT3BhY2l0eT5cbiAqICAgICAgICAgKTtcbiAqICAgICAgIH1cbiAqICAgICB9XG4gKlxuICogICAgIGNsYXNzIE11bHRpU2VsZWN0TGlzdCBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQge1xuICogICAgICAgc3RhdGUgPSB7c2VsZWN0ZWQ6IChuZXcgTWFwKCk6IE1hcDxzdHJpbmcsIGJvb2xlYW4+KX07XG4gKlxuICogICAgICAgX2tleUV4dHJhY3RvciA9IChpdGVtLCBpbmRleCkgPT4gaXRlbS5pZDtcbiAqXG4gKiAgICAgICBfb25QcmVzc0l0ZW0gPSAoaWQ6IHN0cmluZykgPT4ge1xuICogICAgICAgICAvLyB1cGRhdGVyIGZ1bmN0aW9ucyBhcmUgcHJlZmVycmVkIGZvciB0cmFuc2FjdGlvbmFsIHVwZGF0ZXNcbiAqICAgICAgICAgdGhpcy5zZXRTdGF0ZSgoc3RhdGUpID0+IHtcbiAqICAgICAgICAgICAvLyBjb3B5IHRoZSBtYXAgcmF0aGVyIHRoYW4gbW9kaWZ5aW5nIHN0YXRlLlxuICogICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gbmV3IE1hcChzdGF0ZS5zZWxlY3RlZCk7XG4gKiAgICAgICAgICAgc2VsZWN0ZWQuc2V0KGlkLCAhc2VsZWN0ZWQuZ2V0KGlkKSk7IC8vIHRvZ2dsZVxuICogICAgICAgICAgIHJldHVybiB7c2VsZWN0ZWR9O1xuICogICAgICAgICB9KTtcbiAqICAgICAgIH07XG4gKlxuICogICAgICAgX3JlbmRlckl0ZW0gPSAoe2l0ZW19KSA9PiAoXG4gKiAgICAgICAgIDxNeUxpc3RJdGVtXG4gKiAgICAgICAgICAgaWQ9e2l0ZW0uaWR9XG4gKiAgICAgICAgICAgb25QcmVzc0l0ZW09e3RoaXMuX29uUHJlc3NJdGVtfVxuICogICAgICAgICAgIHNlbGVjdGVkPXshIXRoaXMuc3RhdGUuc2VsZWN0ZWQuZ2V0KGl0ZW0uaWQpfVxuICogICAgICAgICAgIHRpdGxlPXtpdGVtLnRpdGxlfVxuICogICAgICAgICAvPlxuICogICAgICAgKTtcbiAqXG4gKiAgICAgICByZW5kZXIoKSB7XG4gKiAgICAgICAgIHJldHVybiAoXG4gKiAgICAgICAgICAgPEZsYXRMaXN0XG4gKiAgICAgICAgICAgICBkYXRhPXt0aGlzLnByb3BzLmRhdGF9XG4gKiAgICAgICAgICAgICBleHRyYURhdGE9e3RoaXMuc3RhdGV9XG4gKiAgICAgICAgICAgICBrZXlFeHRyYWN0b3I9e3RoaXMuX2tleUV4dHJhY3Rvcn1cbiAqICAgICAgICAgICAgIHJlbmRlckl0ZW09e3RoaXMuX3JlbmRlckl0ZW19XG4gKiAgICAgICAgICAgLz5cbiAqICAgICAgICAgKTtcbiAqICAgICAgIH1cbiAqICAgICB9XG4gKlxuICogVGhpcyBpcyBhIGNvbnZlbmllbmNlIHdyYXBwZXIgYXJvdW5kIFtgPFZpcnR1YWxpemVkTGlzdD5gXShkb2NzL3ZpcnR1YWxpemVkbGlzdC5odG1sKSxcbiAqIGFuZCB0aHVzIGluaGVyaXRzIGl0cyBwcm9wcyAoYXMgd2VsbCBhcyB0aG9zZSBvZiBgU2Nyb2xsVmlld2ApIHRoYXQgYXJlbid0IGV4cGxpY2l0bHkgbGlzdGVkXG4gKiBoZXJlLCBhbG9uZyB3aXRoIHRoZSBmb2xsb3dpbmcgY2F2ZWF0czpcbiAqXG4gKiAtIEludGVybmFsIHN0YXRlIGlzIG5vdCBwcmVzZXJ2ZWQgd2hlbiBjb250ZW50IHNjcm9sbHMgb3V0IG9mIHRoZSByZW5kZXIgd2luZG93LiBNYWtlIHN1cmUgYWxsXG4gKiAgIHlvdXIgZGF0YSBpcyBjYXB0dXJlZCBpbiB0aGUgaXRlbSBkYXRhIG9yIGV4dGVybmFsIHN0b3JlcyBsaWtlIEZsdXgsIFJlZHV4LCBvciBSZWxheS5cbiAqIC0gVGhpcyBpcyBhIGBQdXJlQ29tcG9uZW50YCB3aGljaCBtZWFucyB0aGF0IGl0IHdpbGwgbm90IHJlLXJlbmRlciBpZiBgcHJvcHNgIHJlbWFpbiBzaGFsbG93LVxuICogICBlcXVhbC4gTWFrZSBzdXJlIHRoYXQgZXZlcnl0aGluZyB5b3VyIGByZW5kZXJJdGVtYCBmdW5jdGlvbiBkZXBlbmRzIG9uIGlzIHBhc3NlZCBhcyBhIHByb3BcbiAqICAgKGUuZy4gYGV4dHJhRGF0YWApIHRoYXQgaXMgbm90IGA9PT1gIGFmdGVyIHVwZGF0ZXMsIG90aGVyd2lzZSB5b3VyIFVJIG1heSBub3QgdXBkYXRlIG9uXG4gKiAgIGNoYW5nZXMuIFRoaXMgaW5jbHVkZXMgdGhlIGBkYXRhYCBwcm9wIGFuZCBwYXJlbnQgY29tcG9uZW50IHN0YXRlLlxuICogLSBJbiBvcmRlciB0byBjb25zdHJhaW4gbWVtb3J5IGFuZCBlbmFibGUgc21vb3RoIHNjcm9sbGluZywgY29udGVudCBpcyByZW5kZXJlZCBhc3luY2hyb25vdXNseVxuICogICBvZmZzY3JlZW4uIFRoaXMgbWVhbnMgaXQncyBwb3NzaWJsZSB0byBzY3JvbGwgZmFzdGVyIHRoYW4gdGhlIGZpbGwgcmF0ZSBhbmRzIG1vbWVudGFyaWx5IHNlZVxuICogICBibGFuayBjb250ZW50LiBUaGlzIGlzIGEgdHJhZGVvZmYgdGhhdCBjYW4gYmUgYWRqdXN0ZWQgdG8gc3VpdCB0aGUgbmVlZHMgb2YgZWFjaCBhcHBsaWNhdGlvbixcbiAqICAgYW5kIHdlIGFyZSB3b3JraW5nIG9uIGltcHJvdmluZyBpdCBiZWhpbmQgdGhlIHNjZW5lcy5cbiAqIC0gQnkgZGVmYXVsdCwgdGhlIGxpc3QgbG9va3MgZm9yIGEgYGtleWAgcHJvcCBvbiBlYWNoIGl0ZW0gYW5kIHVzZXMgdGhhdCBmb3IgdGhlIFJlYWN0IGtleS5cbiAqICAgQWx0ZXJuYXRpdmVseSwgeW91IGNhbiBwcm92aWRlIGEgY3VzdG9tIGBrZXlFeHRyYWN0b3JgIHByb3AuXG4gKlxuICogQWxzbyBpbmhlcml0cyBbU2Nyb2xsVmlldyBQcm9wc10oZG9jcy9zY3JvbGx2aWV3Lmh0bWwjcHJvcHMpLCB1bmxlc3MgaXQgaXMgbmVzdGVkIGluIGFub3RoZXIgRmxhdExpc3Qgb2Ygc2FtZSBvcmllbnRhdGlvbi5cbiAqL1xuY2xhc3MgRmxhdExpc3Q8SXRlbVQ+IGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxQcm9wczxJdGVtVD4sIHZvaWQ+IHtcbiAgcHJvcHM6IFByb3BzPEl0ZW1UPjtcbiAgLyoqXG4gICAqIFNjcm9sbHMgdG8gdGhlIGVuZCBvZiB0aGUgY29udGVudC4gTWF5IGJlIGphbmt5IHdpdGhvdXQgYGdldEl0ZW1MYXlvdXRgIHByb3AuXG4gICAqL1xuICBzY3JvbGxUb0VuZChwYXJhbXM/OiA/e2FuaW1hdGVkPzogP2Jvb2xlYW4sIC4uLn0pIHtcbiAgICBpZiAodGhpcy5fbGlzdFJlZikge1xuICAgICAgdGhpcy5fbGlzdFJlZi5zY3JvbGxUb0VuZChwYXJhbXMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGxzIHRvIHRoZSBpdGVtIGF0IHRoZSBzcGVjaWZpZWQgaW5kZXggc3VjaCB0aGF0IGl0IGlzIHBvc2l0aW9uZWQgaW4gdGhlIHZpZXdhYmxlIGFyZWFcbiAgICogc3VjaCB0aGF0IGB2aWV3UG9zaXRpb25gIDAgcGxhY2VzIGl0IGF0IHRoZSB0b3AsIDEgYXQgdGhlIGJvdHRvbSwgYW5kIDAuNSBjZW50ZXJlZCBpbiB0aGVcbiAgICogbWlkZGxlLiBgdmlld09mZnNldGAgaXMgYSBmaXhlZCBudW1iZXIgb2YgcGl4ZWxzIHRvIG9mZnNldCB0aGUgZmluYWwgdGFyZ2V0IHBvc2l0aW9uLlxuICAgKlxuICAgKiBOb3RlOiBjYW5ub3Qgc2Nyb2xsIHRvIGxvY2F0aW9ucyBvdXRzaWRlIHRoZSByZW5kZXIgd2luZG93IHdpdGhvdXQgc3BlY2lmeWluZyB0aGVcbiAgICogYGdldEl0ZW1MYXlvdXRgIHByb3AuXG4gICAqL1xuICBzY3JvbGxUb0luZGV4KHBhcmFtczoge1xuICAgIGFuaW1hdGVkPzogP2Jvb2xlYW4sXG4gICAgaW5kZXg6IG51bWJlcixcbiAgICB2aWV3T2Zmc2V0PzogbnVtYmVyLFxuICAgIHZpZXdQb3NpdGlvbj86IG51bWJlcixcbiAgICAuLi5cbiAgfSkge1xuICAgIGlmICh0aGlzLl9saXN0UmVmKSB7XG4gICAgICB0aGlzLl9saXN0UmVmLnNjcm9sbFRvSW5kZXgocGFyYW1zKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVxdWlyZXMgbGluZWFyIHNjYW4gdGhyb3VnaCBkYXRhIC0gdXNlIGBzY3JvbGxUb0luZGV4YCBpbnN0ZWFkIGlmIHBvc3NpYmxlLlxuICAgKlxuICAgKiBOb3RlOiBjYW5ub3Qgc2Nyb2xsIHRvIGxvY2F0aW9ucyBvdXRzaWRlIHRoZSByZW5kZXIgd2luZG93IHdpdGhvdXQgc3BlY2lmeWluZyB0aGVcbiAgICogYGdldEl0ZW1MYXlvdXRgIHByb3AuXG4gICAqL1xuICBzY3JvbGxUb0l0ZW0ocGFyYW1zOiB7XG4gICAgYW5pbWF0ZWQ/OiA/Ym9vbGVhbixcbiAgICBpdGVtOiBJdGVtVCxcbiAgICB2aWV3UG9zaXRpb24/OiBudW1iZXIsXG4gICAgLi4uXG4gIH0pIHtcbiAgICBpZiAodGhpcy5fbGlzdFJlZikge1xuICAgICAgdGhpcy5fbGlzdFJlZi5zY3JvbGxUb0l0ZW0ocGFyYW1zKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2Nyb2xsIHRvIGEgc3BlY2lmaWMgY29udGVudCBwaXhlbCBvZmZzZXQgaW4gdGhlIGxpc3QuXG4gICAqXG4gICAqIENoZWNrIG91dCBbc2Nyb2xsVG9PZmZzZXRdKGRvY3MvdmlydHVhbGl6ZWRsaXN0Lmh0bWwjc2Nyb2xsdG9vZmZzZXQpIG9mIFZpcnR1YWxpemVkTGlzdFxuICAgKi9cbiAgc2Nyb2xsVG9PZmZzZXQocGFyYW1zOiB7YW5pbWF0ZWQ/OiA/Ym9vbGVhbiwgb2Zmc2V0OiBudW1iZXIsIC4uLn0pIHtcbiAgICBpZiAodGhpcy5fbGlzdFJlZikge1xuICAgICAgdGhpcy5fbGlzdFJlZi5zY3JvbGxUb09mZnNldChwYXJhbXMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUZWxscyB0aGUgbGlzdCBhbiBpbnRlcmFjdGlvbiBoYXMgb2NjdXJyZWQsIHdoaWNoIHNob3VsZCB0cmlnZ2VyIHZpZXdhYmlsaXR5IGNhbGN1bGF0aW9ucywgZS5nLlxuICAgKiBpZiBgd2FpdEZvckludGVyYWN0aW9uc2AgaXMgdHJ1ZSBhbmQgdGhlIHVzZXIgaGFzIG5vdCBzY3JvbGxlZC4gVGhpcyBpcyB0eXBpY2FsbHkgY2FsbGVkIGJ5XG4gICAqIHRhcHMgb24gaXRlbXMgb3IgYnkgbmF2aWdhdGlvbiBhY3Rpb25zLlxuICAgKi9cbiAgcmVjb3JkSW50ZXJhY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIHRoaXMuX2xpc3RSZWYucmVjb3JkSW50ZXJhY3Rpb24oKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGlzcGxheXMgdGhlIHNjcm9sbCBpbmRpY2F0b3JzIG1vbWVudGFyaWx5LlxuICAgKlxuICAgKiBAcGxhdGZvcm0gaW9zXG4gICAqL1xuICBmbGFzaFNjcm9sbEluZGljYXRvcnMoKSB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIHRoaXMuX2xpc3RSZWYuZmxhc2hTY3JvbGxJbmRpY2F0b3JzKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFByb3ZpZGVzIGEgaGFuZGxlIHRvIHRoZSB1bmRlcmx5aW5nIHNjcm9sbCByZXNwb25kZXIuXG4gICAqL1xuICBnZXRTY3JvbGxSZXNwb25kZXIoKTogP1Njcm9sbFJlc3BvbmRlclR5cGUge1xuICAgIGlmICh0aGlzLl9saXN0UmVmKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbGlzdFJlZi5nZXRTY3JvbGxSZXNwb25kZXIoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUHJvdmlkZXMgYSByZWZlcmVuY2UgdG8gdGhlIHVuZGVybHlpbmcgaG9zdCBjb21wb25lbnRcbiAgICovXG4gIGdldE5hdGl2ZVNjcm9sbFJlZigpOlxuICAgIHwgP1JlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIFZpZXc+XG4gICAgfCA/UmVhY3QuRWxlbWVudFJlZjxTY3JvbGxWaWV3TmF0aXZlQ29tcG9uZW50PiB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIC8qICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXJldHVybl0gU3VwcHJlc3NlcyBlcnJvcnMgZm91bmQgd2hlbiBmaXhpbmdcbiAgICAgICAqIFRleHRJbnB1dCB0eXBpbmcgKi9cbiAgICAgIHJldHVybiB0aGlzLl9saXN0UmVmLmdldFNjcm9sbFJlZigpO1xuICAgIH1cbiAgfVxuXG4gIGdldFNjcm9sbGFibGVOb2RlKCk6IGFueSB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIHJldHVybiB0aGlzLl9saXN0UmVmLmdldFNjcm9sbGFibGVOb2RlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0TmF0aXZlUHJvcHMocHJvcHM6IHtbc3RyaW5nXTogbWl4ZWQsIC4uLn0pIHtcbiAgICBpZiAodGhpcy5fbGlzdFJlZikge1xuICAgICAgdGhpcy5fbGlzdFJlZi5zZXROYXRpdmVQcm9wcyhwcm9wcyk7XG4gICAgfVxuICB9XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzPEl0ZW1UPikge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLl9jaGVja1Byb3BzKHRoaXMucHJvcHMpO1xuICAgIGlmICh0aGlzLnByb3BzLnZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycykge1xuICAgICAgdGhpcy5fdmlydHVhbGl6ZWRMaXN0UGFpcnMgPSB0aGlzLnByb3BzLnZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycy5tYXAoXG4gICAgICAgIHBhaXIgPT4gKHtcbiAgICAgICAgICB2aWV3YWJpbGl0eUNvbmZpZzogcGFpci52aWV3YWJpbGl0eUNvbmZpZyxcbiAgICAgICAgICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkOiB0aGlzLl9jcmVhdGVPblZpZXdhYmxlSXRlbXNDaGFuZ2VkKFxuICAgICAgICAgICAgcGFpci5vblZpZXdhYmxlSXRlbXNDaGFuZ2VkLFxuICAgICAgICAgICksXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMub25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCkge1xuICAgICAgdGhpcy5fdmlydHVhbGl6ZWRMaXN0UGFpcnMucHVzaCh7XG4gICAgICAgIC8qICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdICg+PTAuNjMuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpc1xuICAgICAgICAgKiBjb21tZW50IHN1cHByZXNzZXMgYW4gZXJyb3IgZm91bmQgd2hlbiBGbG93IHYwLjYzIHdhcyBkZXBsb3llZC4gVG9cbiAgICAgICAgICogc2VlIHRoZSBlcnJvciBkZWxldGUgdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICAgICAgdmlld2FiaWxpdHlDb25maWc6IHRoaXMucHJvcHMudmlld2FiaWxpdHlDb25maWcsXG4gICAgICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQ6IHRoaXMuX2NyZWF0ZU9uVmlld2FibGVJdGVtc0NoYW5nZWQoXG4gICAgICAgICAgdGhpcy5wcm9wcy5vblZpZXdhYmxlSXRlbXNDaGFuZ2VkLFxuICAgICAgICApLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wczogUHJvcHM8SXRlbVQ+KSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgcHJldlByb3BzLm51bUNvbHVtbnMgPT09IHRoaXMucHJvcHMubnVtQ29sdW1ucyxcbiAgICAgICdDaGFuZ2luZyBudW1Db2x1bW5zIG9uIHRoZSBmbHkgaXMgbm90IHN1cHBvcnRlZC4gQ2hhbmdlIHRoZSBrZXkgcHJvcCBvbiBGbGF0TGlzdCB3aGVuICcgK1xuICAgICAgICAnY2hhbmdpbmcgdGhlIG51bWJlciBvZiBjb2x1bW5zIHRvIGZvcmNlIGEgZnJlc2ggcmVuZGVyIG9mIHRoZSBjb21wb25lbnQuJyxcbiAgICApO1xuICAgIGludmFyaWFudChcbiAgICAgIHByZXZQcm9wcy5vblZpZXdhYmxlSXRlbXNDaGFuZ2VkID09PSB0aGlzLnByb3BzLm9uVmlld2FibGVJdGVtc0NoYW5nZWQsXG4gICAgICAnQ2hhbmdpbmcgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCBvbiB0aGUgZmx5IGlzIG5vdCBzdXBwb3J0ZWQnLFxuICAgICk7XG4gICAgaW52YXJpYW50KFxuICAgICAgIWRlZXBEaWZmZXIocHJldlByb3BzLnZpZXdhYmlsaXR5Q29uZmlnLCB0aGlzLnByb3BzLnZpZXdhYmlsaXR5Q29uZmlnKSxcbiAgICAgICdDaGFuZ2luZyB2aWV3YWJpbGl0eUNvbmZpZyBvbiB0aGUgZmx5IGlzIG5vdCBzdXBwb3J0ZWQnLFxuICAgICk7XG4gICAgaW52YXJpYW50KFxuICAgICAgcHJldlByb3BzLnZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycyA9PT1cbiAgICAgICAgdGhpcy5wcm9wcy52aWV3YWJpbGl0eUNvbmZpZ0NhbGxiYWNrUGFpcnMsXG4gICAgICAnQ2hhbmdpbmcgdmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXJzIG9uIHRoZSBmbHkgaXMgbm90IHN1cHBvcnRlZCcsXG4gICAgKTtcblxuICAgIHRoaXMuX2NoZWNrUHJvcHModGhpcy5wcm9wcyk7XG4gIH1cblxuICBfbGlzdFJlZjogP1JlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIFZpcnR1YWxpemVkTGlzdD47XG4gIF92aXJ0dWFsaXplZExpc3RQYWlyczogQXJyYXk8Vmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXI+ID0gW107XG5cbiAgX2NhcHR1cmVSZWYgPSByZWYgPT4ge1xuICAgIHRoaXMuX2xpc3RSZWYgPSByZWY7XG4gIH07XG5cbiAgX2NoZWNrUHJvcHMocHJvcHM6IFByb3BzPEl0ZW1UPikge1xuICAgIGNvbnN0IHtcbiAgICAgIC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXSB0aGlzIHByb3AgZG9lc24ndCBleGlzdCwgaXMgb25seSB1c2VkIGZvciBhbiBpbnZhcmlhbnRcbiAgICAgIGdldEl0ZW0sXG4gICAgICAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ10gdGhpcyBwcm9wIGRvZXNuJ3QgZXhpc3QsIGlzIG9ubHkgdXNlZCBmb3IgYW4gaW52YXJpYW50XG4gICAgICBnZXRJdGVtQ291bnQsXG4gICAgICBob3Jpem9udGFsLFxuICAgICAgY29sdW1uV3JhcHBlclN0eWxlLFxuICAgICAgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCxcbiAgICAgIHZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycyxcbiAgICB9ID0gcHJvcHM7XG4gICAgY29uc3QgbnVtQ29sdW1ucyA9IG51bUNvbHVtbnNPckRlZmF1bHQodGhpcy5wcm9wcy5udW1Db2x1bW5zKTtcbiAgICBpbnZhcmlhbnQoXG4gICAgICAhZ2V0SXRlbSAmJiAhZ2V0SXRlbUNvdW50LFxuICAgICAgJ0ZsYXRMaXN0IGRvZXMgbm90IHN1cHBvcnQgY3VzdG9tIGRhdGEgZm9ybWF0cy4nLFxuICAgICk7XG4gICAgaWYgKG51bUNvbHVtbnMgPiAxKSB7XG4gICAgICBpbnZhcmlhbnQoIWhvcml6b250YWwsICdudW1Db2x1bW5zIGRvZXMgbm90IHN1cHBvcnQgaG9yaXpvbnRhbC4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW52YXJpYW50KFxuICAgICAgICAhY29sdW1uV3JhcHBlclN0eWxlLFxuICAgICAgICAnY29sdW1uV3JhcHBlclN0eWxlIG5vdCBzdXBwb3J0ZWQgZm9yIHNpbmdsZSBjb2x1bW4gbGlzdHMnLFxuICAgICAgKTtcbiAgICB9XG4gICAgaW52YXJpYW50KFxuICAgICAgIShvblZpZXdhYmxlSXRlbXNDaGFuZ2VkICYmIHZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycyksXG4gICAgICAnRmxhdExpc3QgZG9lcyBub3Qgc3VwcG9ydCBzZXR0aW5nIGJvdGggb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCBhbmQgJyArXG4gICAgICAgICd2aWV3YWJpbGl0eUNvbmZpZ0NhbGxiYWNrUGFpcnMuJyxcbiAgICApO1xuICB9XG5cbiAgX2dldEl0ZW0gPSAoZGF0YTogQXJyYXk8SXRlbVQ+LCBpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgY29uc3QgbnVtQ29sdW1ucyA9IG51bUNvbHVtbnNPckRlZmF1bHQodGhpcy5wcm9wcy5udW1Db2x1bW5zKTtcbiAgICBpZiAobnVtQ29sdW1ucyA+IDEpIHtcbiAgICAgIGNvbnN0IHJldCA9IFtdO1xuICAgICAgZm9yIChsZXQga2sgPSAwOyBrayA8IG51bUNvbHVtbnM7IGtrKyspIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IGRhdGFbaW5kZXggKiBudW1Db2x1bW5zICsga2tdO1xuICAgICAgICBpZiAoaXRlbSAhPSBudWxsKSB7XG4gICAgICAgICAgcmV0LnB1c2goaXRlbSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBkYXRhW2luZGV4XTtcbiAgICB9XG4gIH07XG5cbiAgX2dldEl0ZW1Db3VudCA9IChkYXRhOiA/QXJyYXk8SXRlbVQ+KTogbnVtYmVyID0+IHtcbiAgICBpZiAoZGF0YSkge1xuICAgICAgY29uc3QgbnVtQ29sdW1ucyA9IG51bUNvbHVtbnNPckRlZmF1bHQodGhpcy5wcm9wcy5udW1Db2x1bW5zKTtcbiAgICAgIHJldHVybiBudW1Db2x1bW5zID4gMSA/IE1hdGguY2VpbChkYXRhLmxlbmd0aCAvIG51bUNvbHVtbnMpIDogZGF0YS5sZW5ndGg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfTtcblxuICBfa2V5RXh0cmFjdG9yID0gKGl0ZW1zOiBJdGVtVCB8IEFycmF5PEl0ZW1UPiwgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgIGNvbnN0IG51bUNvbHVtbnMgPSBudW1Db2x1bW5zT3JEZWZhdWx0KHRoaXMucHJvcHMubnVtQ29sdW1ucyk7XG4gICAgY29uc3Qga2V5RXh0cmFjdG9yID0gdGhpcy5wcm9wcy5rZXlFeHRyYWN0b3IgPz8gZGVmYXVsdEtleUV4dHJhY3RvcjtcblxuICAgIGlmIChudW1Db2x1bW5zID4gMSkge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaXRlbXMpKSB7XG4gICAgICAgIHJldHVybiBpdGVtc1xuICAgICAgICAgIC5tYXAoKGl0ZW0sIGtrKSA9PlxuICAgICAgICAgICAga2V5RXh0cmFjdG9yKCgoaXRlbTogJEZsb3dGaXhNZSk6IEl0ZW1UKSwgaW5kZXggKiBudW1Db2x1bW5zICsga2spLFxuICAgICAgICAgIClcbiAgICAgICAgICAuam9pbignOicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW52YXJpYW50KFxuICAgICAgICAgIEFycmF5LmlzQXJyYXkoaXRlbXMpLFxuICAgICAgICAgICdGbGF0TGlzdDogRW5jb3VudGVyZWQgaW50ZXJuYWwgY29uc2lzdGVuY3kgZXJyb3IsIGV4cGVjdGVkIGVhY2ggaXRlbSB0byBjb25zaXN0IG9mIGFuICcgK1xuICAgICAgICAgICAgJ2FycmF5IHdpdGggMS0lcyBjb2x1bW5zOyBpbnN0ZWFkLCByZWNlaXZlZCBhIHNpbmdsZSBpdGVtLicsXG4gICAgICAgICAgbnVtQ29sdW1ucyxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtY2FsbF0gQ2FuJ3QgY2FsbCBrZXlFeHRyYWN0b3Igd2l0aCBhbiBhcnJheVxuICAgICAgcmV0dXJuIGtleUV4dHJhY3RvcihpdGVtcywgaW5kZXgpO1xuICAgIH1cbiAgfTtcblxuICBfcHVzaE11bHRpQ29sdW1uVmlld2FibGUoYXJyOiBBcnJheTxWaWV3VG9rZW4+LCB2OiBWaWV3VG9rZW4pOiB2b2lkIHtcbiAgICBjb25zdCBudW1Db2x1bW5zID0gbnVtQ29sdW1uc09yRGVmYXVsdCh0aGlzLnByb3BzLm51bUNvbHVtbnMpO1xuICAgIGNvbnN0IGtleUV4dHJhY3RvciA9IHRoaXMucHJvcHMua2V5RXh0cmFjdG9yID8/IGRlZmF1bHRLZXlFeHRyYWN0b3I7XG4gICAgdi5pdGVtLmZvckVhY2goKGl0ZW0sIGlpKSA9PiB7XG4gICAgICBpbnZhcmlhbnQodi5pbmRleCAhPSBudWxsLCAnTWlzc2luZyBpbmRleCEnKTtcbiAgICAgIGNvbnN0IGluZGV4ID0gdi5pbmRleCAqIG51bUNvbHVtbnMgKyBpaTtcbiAgICAgIGFyci5wdXNoKHsuLi52LCBpdGVtLCBrZXk6IGtleUV4dHJhY3RvcihpdGVtLCBpbmRleCksIGluZGV4fSk7XG4gICAgfSk7XG4gIH1cblxuICBfY3JlYXRlT25WaWV3YWJsZUl0ZW1zQ2hhbmdlZChcbiAgICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkOiA/KGluZm86IHtcbiAgICAgIHZpZXdhYmxlSXRlbXM6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgICBjaGFuZ2VkOiBBcnJheTxWaWV3VG9rZW4+LFxuICAgICAgLi4uXG4gICAgfSkgPT4gdm9pZCxcbiAgKSB7XG4gICAgcmV0dXJuIChpbmZvOiB7XG4gICAgICB2aWV3YWJsZUl0ZW1zOiBBcnJheTxWaWV3VG9rZW4+LFxuICAgICAgY2hhbmdlZDogQXJyYXk8Vmlld1Rva2VuPixcbiAgICAgIC4uLlxuICAgIH0pID0+IHtcbiAgICAgIGNvbnN0IG51bUNvbHVtbnMgPSBudW1Db2x1bW5zT3JEZWZhdWx0KHRoaXMucHJvcHMubnVtQ29sdW1ucyk7XG4gICAgICBpZiAob25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCkge1xuICAgICAgICBpZiAobnVtQ29sdW1ucyA+IDEpIHtcbiAgICAgICAgICBjb25zdCBjaGFuZ2VkID0gW107XG4gICAgICAgICAgY29uc3Qgdmlld2FibGVJdGVtcyA9IFtdO1xuICAgICAgICAgIGluZm8udmlld2FibGVJdGVtcy5mb3JFYWNoKHYgPT5cbiAgICAgICAgICAgIHRoaXMuX3B1c2hNdWx0aUNvbHVtblZpZXdhYmxlKHZpZXdhYmxlSXRlbXMsIHYpLFxuICAgICAgICAgICk7XG4gICAgICAgICAgaW5mby5jaGFuZ2VkLmZvckVhY2godiA9PiB0aGlzLl9wdXNoTXVsdGlDb2x1bW5WaWV3YWJsZShjaGFuZ2VkLCB2KSk7XG4gICAgICAgICAgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCh7dmlld2FibGVJdGVtcywgY2hhbmdlZH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQoaW5mbyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgX3JlbmRlcmVyID0gKCkgPT4ge1xuICAgIGNvbnN0IHtMaXN0SXRlbUNvbXBvbmVudCwgcmVuZGVySXRlbSwgY29sdW1uV3JhcHBlclN0eWxlfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgbnVtQ29sdW1ucyA9IG51bUNvbHVtbnNPckRlZmF1bHQodGhpcy5wcm9wcy5udW1Db2x1bW5zKTtcblxuICAgIGxldCB2aXJ0dWFsaXplZExpc3RSZW5kZXJLZXkgPSBMaXN0SXRlbUNvbXBvbmVudFxuICAgICAgPyAnTGlzdEl0ZW1Db21wb25lbnQnXG4gICAgICA6ICdyZW5kZXJJdGVtJztcblxuICAgIGNvbnN0IHJlbmRlcmVyID0gKHByb3BzKTogUmVhY3QuTm9kZSA9PiB7XG4gICAgICBpZiAoTGlzdEl0ZW1Db21wb25lbnQpIHtcbiAgICAgICAgLy8gJEZsb3dGaXhNZVtub3QtYS1jb21wb25lbnRdIENvbXBvbmVudCBpc24ndCB2YWxpZFxuICAgICAgICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS10eXBlLWFyZ10gQ29tcG9uZW50IGlzbid0IHZhbGlkXG4gICAgICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXJldHVybl0gQ29tcG9uZW50IGlzbid0IHZhbGlkXG4gICAgICAgIHJldHVybiA8TGlzdEl0ZW1Db21wb25lbnQgey4uLnByb3BzfSAvPjtcbiAgICAgIH0gZWxzZSBpZiAocmVuZGVySXRlbSkge1xuICAgICAgICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1jYWxsXVxuICAgICAgICByZXR1cm4gcmVuZGVySXRlbShwcm9wcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIC8qICRGbG93Rml4TWVbaW52YWxpZC1jb21wdXRlZC1wcm9wXSAoPj0wLjExMS4wIHNpdGU9cmVhY3RfbmF0aXZlX2ZiKVxuICAgICAgICogVGhpcyBjb21tZW50IHN1cHByZXNzZXMgYW4gZXJyb3IgZm91bmQgd2hlbiBGbG93IHYwLjExMSB3YXMgZGVwbG95ZWQuXG4gICAgICAgKiBUbyBzZWUgdGhlIGVycm9yLCBkZWxldGUgdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICAgIFt2aXJ0dWFsaXplZExpc3RSZW5kZXJLZXldOiAoaW5mbzogUmVuZGVySXRlbVByb3BzPEl0ZW1UPikgPT4ge1xuICAgICAgICBpZiAobnVtQ29sdW1ucyA+IDEpIHtcbiAgICAgICAgICBjb25zdCB7aXRlbSwgaW5kZXh9ID0gaW5mbztcbiAgICAgICAgICBpbnZhcmlhbnQoXG4gICAgICAgICAgICBBcnJheS5pc0FycmF5KGl0ZW0pLFxuICAgICAgICAgICAgJ0V4cGVjdGVkIGFycmF5IG9mIGl0ZW1zIHdpdGggbnVtQ29sdW1ucyA+IDEnLFxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxWaWV3IHN0eWxlPXtTdHlsZVNoZWV0LmNvbXBvc2Uoc3R5bGVzLnJvdywgY29sdW1uV3JhcHBlclN0eWxlKX0+XG4gICAgICAgICAgICAgIHtpdGVtLm1hcCgoaXQsIGtrKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IHJlbmRlcmVyKHtcbiAgICAgICAgICAgICAgICAgIGl0ZW06IGl0LFxuICAgICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4ICogbnVtQ29sdW1ucyArIGtrLFxuICAgICAgICAgICAgICAgICAgc2VwYXJhdG9yczogaW5mby5zZXBhcmF0b3JzLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50ICE9IG51bGwgPyAoXG4gICAgICAgICAgICAgICAgICA8UmVhY3QuRnJhZ21lbnQga2V5PXtra30+e2VsZW1lbnR9PC9SZWFjdC5GcmFnbWVudD5cbiAgICAgICAgICAgICAgICApIDogbnVsbDtcbiAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gcmVuZGVyZXIoaW5mbyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfTtcbiAgfTtcblxuICByZW5kZXIoKTogUmVhY3QuTm9kZSB7XG4gICAgY29uc3Qge1xuICAgICAgbnVtQ29sdW1ucyxcbiAgICAgIGNvbHVtbldyYXBwZXJTdHlsZSxcbiAgICAgIHJlbW92ZUNsaXBwZWRTdWJ2aWV3czogX3JlbW92ZUNsaXBwZWRTdWJ2aWV3cyxcbiAgICAgIC4uLnJlc3RQcm9wc1xuICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxWaXJ0dWFsaXplZExpc3RcbiAgICAgICAgey4uLnJlc3RQcm9wc31cbiAgICAgICAgZ2V0SXRlbT17dGhpcy5fZ2V0SXRlbX1cbiAgICAgICAgZ2V0SXRlbUNvdW50PXt0aGlzLl9nZXRJdGVtQ291bnR9XG4gICAgICAgIGtleUV4dHJhY3Rvcj17dGhpcy5fa2V5RXh0cmFjdG9yfVxuICAgICAgICByZWY9e3RoaXMuX2NhcHR1cmVSZWZ9XG4gICAgICAgIHZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycz17dGhpcy5fdmlydHVhbGl6ZWRMaXN0UGFpcnN9XG4gICAgICAgIHJlbW92ZUNsaXBwZWRTdWJ2aWV3cz17cmVtb3ZlQ2xpcHBlZFN1YnZpZXdzT3JEZWZhdWx0KFxuICAgICAgICAgIF9yZW1vdmVDbGlwcGVkU3Vidmlld3MsXG4gICAgICAgICl9XG4gICAgICAgIHsuLi50aGlzLl9yZW5kZXJlcigpfVxuICAgICAgLz5cbiAgICApO1xuICB9XG59XG5cbmNvbnN0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHtcbiAgcm93OiB7ZmxleERpcmVjdGlvbjogJ3Jvdyd9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gRmxhdExpc3Q7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBMkJBLElBQUFBLGdCQUFBLEdBQUFDLE9BQUE7QUFBc0UsSUFBQUMsU0FBQTtBQUFBLFNBQUFDLGFBQUFDLE9BQUEsUUFBQUMseUJBQUEsR0FBQUMs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