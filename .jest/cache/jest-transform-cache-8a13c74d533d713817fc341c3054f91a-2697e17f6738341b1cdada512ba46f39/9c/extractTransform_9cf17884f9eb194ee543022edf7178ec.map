{"version":3,"names":["_Matrix2D","require","_transform","appendTransformProps","props","x","y","originX","originY","scaleX","scaleY","rotation","skewX","skewY","appendTransform","universal2axis","universal","axisX","axisY","defaultValue","coords","split","length","Array","isArray","isNaN","props2transform","translate","translateX","translateY","origin","scale","skew","console","warn","tr","or","sc","sk","transformToMatrix","transform","reset","append","t","parse","e","error","transformProps","toArray","extractTransform","identity"],"sources":["extractTransform.ts"],"sourcesContent":["import { append, appendTransform, identity, reset, toArray } from '../Matrix2D';\nimport { parse } from './transform';\nimport { NumberProp, TransformedProps, TransformProps } from './types';\n\nfunction appendTransformProps(props: TransformedProps) {\n  const { x, y, originX, originY, scaleX, scaleY, rotation, skewX, skewY } =\n    props;\n  appendTransform(\n    x + originX,\n    y + originY,\n    scaleX,\n    scaleY,\n    rotation,\n    skewX,\n    skewY,\n    originX,\n    originY,\n  );\n}\n\nfunction universal2axis(\n  universal: NumberProp | NumberProp[] | undefined,\n  axisX: NumberProp | void,\n  axisY: NumberProp | void,\n  defaultValue?: number,\n): [number, number] {\n  let x;\n  let y;\n  if (typeof universal === 'number') {\n    x = y = universal;\n  } else if (typeof universal === 'string') {\n    const coords = universal.split(/\\s*,\\s*/);\n    if (coords.length === 2) {\n      x = +coords[0];\n      y = +coords[1];\n    } else if (coords.length === 1) {\n      x = y = +coords[0];\n    }\n  } else if (Array.isArray(universal)) {\n    if (universal.length === 2) {\n      x = +universal[0];\n      y = +universal[1];\n    } else if (universal.length === 1) {\n      x = y = +universal[0];\n    }\n  }\n\n  axisX = +axisX;\n  if (!isNaN(axisX)) {\n    x = axisX;\n  }\n\n  axisY = +axisY;\n  if (!isNaN(axisY)) {\n    y = axisY;\n  }\n\n  return [x || defaultValue || 0, y || defaultValue || 0];\n}\n\nexport function props2transform(\n  props: TransformProps,\n): TransformedProps | null {\n  const {\n    rotation,\n    translate,\n    translateX,\n    translateY,\n    origin,\n    originX,\n    originY,\n    scale,\n    scaleX,\n    scaleY,\n    skew,\n    skewX,\n    skewY,\n    x,\n    y,\n  } = props;\n  if (\n    rotation == null &&\n    translate == null &&\n    translateX == null &&\n    translateY == null &&\n    origin == null &&\n    originX == null &&\n    originY == null &&\n    scale == null &&\n    scaleX == null &&\n    scaleY == null &&\n    skew == null &&\n    skewX == null &&\n    skewY == null &&\n    x == null &&\n    y == null\n  ) {\n    return null;\n  }\n\n  if (Array.isArray(x) || Array.isArray(y)) {\n    console.warn(\n      'Passing SvgLengthList to x or y attribute where SvgLength expected',\n    );\n  }\n  const tr = universal2axis(\n    translate,\n    translateX || (Array.isArray(x) ? x[0] : x),\n    translateY || (Array.isArray(y) ? y[0] : y),\n  );\n  const or = universal2axis(origin, originX, originY);\n  const sc = universal2axis(scale, scaleX, scaleY, 1);\n  const sk = universal2axis(skew, skewX, skewY);\n\n  return {\n    rotation: rotation == null ? 0 : +rotation || 0,\n    originX: or[0],\n    originY: or[1],\n    scaleX: sc[0],\n    scaleY: sc[1],\n    skewX: sk[0],\n    skewY: sk[1],\n    x: tr[0],\n    y: tr[1],\n  };\n}\n\nexport function transformToMatrix(\n  props: TransformedProps | null,\n  transform: number[] | string | TransformProps | void | null | undefined,\n): [number, number, number, number, number, number] | null {\n  if (!props && !transform) {\n    return null;\n  }\n  reset();\n  props && appendTransformProps(props);\n\n  if (transform) {\n    if (Array.isArray(transform)) {\n      if (typeof transform[0] === 'number') {\n        append(\n          transform[0],\n          transform[1],\n          transform[2],\n          transform[3],\n          transform[4],\n          transform[5],\n        );\n      }\n      // noop for react-native transform arrays, let animated handle them\n    } else if (typeof transform === 'string') {\n      try {\n        const t = parse(transform);\n        append(t[0], t[3], t[1], t[4], t[2], t[5]);\n      } catch (e) {\n        console.error(e);\n      }\n    } else {\n      const transformProps = props2transform(transform);\n      transformProps && appendTransformProps(transformProps);\n    }\n  }\n\n  return toArray();\n}\n\nexport default function extractTransform(\n  props: number[] | string | TransformProps,\n) {\n  if (Array.isArray(props)) {\n    return props;\n  }\n  if (typeof props === 'string') {\n    try {\n      const t = parse(props);\n      return [t[0], t[3], t[1], t[4], t[2], t[5]];\n    } catch (e) {\n      console.error(e);\n      return identity;\n    }\n  }\n  return transformToMatrix(props2transform(props), props.transform);\n}\n"],"mappings":"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"}